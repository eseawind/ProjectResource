{"inframe":false,"title":"创建JNDI","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverMethod":"com.wb.interact.Install.checkInstall","itemId":"module"},"children":[{"configs":{"layout":"fit","itemId":"viewport1"},"events":{"afterrender":"viewport.mon(viewport.el, 'keydown', function(e) {\n  if (e.getKey() == e.ENTER) {\n    app.createBtn.fireEvent('click');\n  }\n});"},"children":[{"configs":{"autoScroll":"true","layout":"anchor","itemId":"container1","padding":"10"},"children":[{"configs":{"width":"470","html":"<p>提示：本模块仅支持兼容于Tomcat和部分常用数据库的JNDI数据源创建，其他Web应用服务器和数据库的JNDI数据源创建请参考各自的配置文档。<\/p>","itemId":"descComp"},"children":[],"expanded":false,"type":"comp"},{"configs":{"title":"JNDI 数据源创建","layout":"fit","width":"470","itemId":"fieldset1"},"children":[{"configs":{"height":"288","autoScroll":"true","width":"440","layout":"absolute","itemId":"operCon"},"children":[{"configs":{"height":"22","allowBlank":"false","width":"400","pickList":"[\n  ['m', 'MySQL'],\n  ['o', 'Oracle'],\n  ['s', 'SQL Server']\n]","labelAlign":"right","itemId":"dbType","fieldLabel":"数据库类型","editable":"false","y":"16","x":"16"},"children":[],"expanded":false,"type":"combo"},{"configs":{"height":"22","allowBlank":"false","validator":"if (app.jndi.getValue().indexOf('/') != -1)\n  return 'JNDI名称不允许包含\u201c/\u201d，有效值如：mydb';\nelse return true;","width":"200","labelAlign":"right","itemId":"jndi","fieldLabel":"JNDI名称","y":"48","x":"16"},"events":{"change":"app.fullJndi.setValue('java:comp/env/jdbc/' + newValue);"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","readOnly":"true","width":"192","itemId":"fullJndi","y":"48","x":"224"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","allowBlank":"false","width":"400","labelAlign":"right","itemId":"ip","fieldLabel":"数据库IP","y":"80","x":"16"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","allowBlank":"false","width":"400","labelAlign":"right","itemId":"port","fieldLabel":"数据库端口","y":"112","x":"16"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","allowBlank":"false","width":"400","labelAlign":"right","itemId":"dbname","fieldLabel":"数据库名称","y":"144","x":"16"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","allowBlank":"false","width":"400","labelAlign":"right","itemId":"username","fieldLabel":"数据库用户名","y":"176","x":"16"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"22","allowBlank":"false","width":"400","labelAlign":"right","itemId":"password","fieldLabel":"数据库密码","y":"208","x":"16"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"创建JNDI","height":"22","width":"88","itemId":"createBtn","y":"248","x":"232"},"events":{"click":"if (!Wb.verify(app.operCon))\n  return;\n\nfunction doCreate(overwrite) {\n  Wb.request({\n    url: 'm?xwl=sys/service/install/generate-jndi',\n    out: app.viewport1,\n    params: {\n      overwrite: overwrite\n    },\n    showError: false,\n    success: function(resp) {\n      Wb.info('已经创建JNDI数据源。请不要关闭本页面，并在重启Tomcat后点击[测试连接]按钮测试JNDI有效性。');\n    },\n    failure: function(resp) {\n      var msg = resp.responseText,\n        errMsg = Wb.getError(msg, 106);\n      if (errMsg) {\n        Wb.confirm(errMsg, function() {\n          doCreate(true);\n        });\n      } else\n        Wb.except(resp);\n    }\n  });\n}\ndoCreate(false);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"测试连接","height":"22","width":"88","itemId":"testBtn","y":"248","x":"328"},"events":{"click":" Wb.request({\n   url: 'm?xwl=sys/service/install/test-jndi',\n   showError: false,\n   timeout: -1,\n   params: {\n     jndi: 'java:comp/env/jdbc/' + app.jndi.getValue()\n   },\n   failure: function(resp) {\n     Wb.error('连接数据库失败，请确认JNDI是否已经被创建，并在检查配置后再试一次。<br>' + Wb.encodeHtml(resp.responseText));\n   },\n   success: function() {\n     Wb.info('连接数据库成功。JNDI全名为：java:comp/env/jdbc/' + app.jndi.getValue());\n   }\n });"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"container"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"container"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}