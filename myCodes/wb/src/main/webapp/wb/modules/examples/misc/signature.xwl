{"title":"手写签名","inframe":false,"hidden":false,"roles":{"demo":1},"pageLink":"","children":[{"configs":{"itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"events":{"afterrender":"function onMouseMove(evt) {\n  evt.preventDefault();\n  if (flag) {\n    var p = pos(evt);\n    ctx.lineTo(p.x, p.y);\n    ctx.lineWidth = 2;\n    ctx.shadowColor = \"#333\";\n    ctx.shadowBlur = 1;\n    ctx.stroke();\n  }\n}\n\nfunction onMouseDown(evt) {\n  evt.preventDefault();\n  ctx.beginPath();\n  var p = pos(evt);\n  ctx.moveTo(p.x, p.y);\n  flag = true;\n}\n\n\nfunction onMouseUp(evt) {\n  evt.preventDefault();\n  flag = false;\n}\n\nfunction pos() {\n  var xy = Ext.EventObject.getXY();\n  return {\n    x: xy[0] - app.comp1.el.getLeft(),\n    y: xy[1] - app.comp1.el.getTop()\n  };\n}\nvar canvas = app.canvas = app.comp1.el.down('[itemId=canvas]', true),\n  ctx = app.context = canvas.getContext('2d'),\n  flag = false;\ncanvas.addEventListener('mousemove', onMouseMove, false);\ncanvas.addEventListener('mousedown', onMouseDown, false);\ncanvas.addEventListener('mouseup', onMouseUp, false);\ncanvas.addEventListener('touchstart', onMouseDown, false);\ncanvas.addEventListener('touchmove', onMouseMove, false);\ncanvas.addEventListener('touchend', onMouseUp, false);\nctx.strokeStyle = \"#333\";","resize":"app.canvas.width = app.comp1.getWidth();\napp.canvas.height = app.comp1.getHeight();"},"children":[{"configs":{"region":"north","itemId":"toolbar1"},"children":[{"configs":{"text":"清除签名","itemId":"clearBtn","iconCls":"delete_icon"},"events":{"click":"app.context.clearRect(0, 0, app.canvas.width, app.canvas.height);"},"children":[],"type":"item","expanded":false},{"configs":{"text":"导出签名","itemId":"exportBtn","iconCls":"export_icon"},"events":{"click":"Wb.download('base64-file', {\n  data: app.canvas.toDataURL(\"image/png\"),\n  file: 'signature.png'\n}, true);"},"children":[],"type":"item","expanded":false},{"configs":{"text":"->","itemId":"item1"},"children":[],"type":"item","expanded":false},{"configs":{"text":"html5示例","xtype":"tbtext","itemId":"html5Text"},"children":[],"type":"item","expanded":false}],"type":"toolbar","expanded":true},{"configs":{"region":"center","html":"<canvas itemId='canvas'><\/canvas>","itemId":"comp1"},"children":[],"type":"comp","expanded":false}],"type":"viewport","expanded":true}],"type":"module","expanded":true}],"iconCls":""}