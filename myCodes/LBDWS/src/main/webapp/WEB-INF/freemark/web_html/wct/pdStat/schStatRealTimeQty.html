<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>卷、包实时产量</title>
<link href="${resRoot}/wct_web/css/pddisplay/ssxh.css" rel="stylesheet"
	type="text/css" />
<!--机台排序-->
<link href="${resRoot}/wct_web/css/pddisplay/gdxx.css" rel="stylesheet"
	type="text/css" />
	<!-- 覆盖样式 -->
<link href="${resRoot}/wct_web/css/pddisplay/sctjQty.css" rel="stylesheet" />
<link href="${resRoot}/wct_web/css/pddisplay/sctjRealTimeQty.css" rel="stylesheet" type="text/css" />
<!--工单信息-->
<script src='${resRoot}/wct_web/js/jquery.js'></script>
<script src="${resRoot}/wct_web/js/wctPage.js"></script>
<script type="text/javascript" language="JavaScript">
	var baseUrl="${futRoot}";
	$(function(){
		//隐藏form
		$("#eqpTypeForm").hide();
		//初始化进度条长度
		<#if (dataList?exists && dataList?size>0)>
			<#list dataList as data>
				$("#qtyPro${data.eqpCode}").width("${data.processVal}");
			</#list>
		</#if>
	});
	//切换卷烟、包装div
	function changeDiv(type) {
		if (type == 1) {
			//设置隐藏表单值，修改类型为卷烟机
			$("#orderTypeVal").val("1");
		} else {
			//设置隐藏表单值，修改类型为包装机
			$("#orderTypeVal").val("2");
		} 
		$("#submitBu").submit();
	}
	/**
	产量排序规则
	**/
	function orderData(orderType){
		if(orderType == 1){
			$("#orderDescVal").val("desc");
			$("#orderAscVal").val("");
		}else if(orderType == 2){
			$("#orderAscVal").val("asc");
			$("#orderDescVal").val("");
		}
		$("#submitBu").submit();
	}
	//定时刷新包装机数据
	function frushPackerQty(){
		$.ajax({
			  url: baseUrl+"/wct/realTimeData/getOutData.json?type=2",
			  cache: false,
			  success: function(msg){
				var eqpCode=null;
				var realQty=0.0;
				var pqty=1.0;
				var processWidth="0%";
			    for(var index=0;index<msg.length;index++){
			    	var data=msg[index];
			    	realQty=data.curOut;
			    	eqpCode=data.eqpCod;
			    	$("#realQty"+eqpCode).html(realQty.toFixed(2));
			    	pqty=$("#pQty"+eqpCode).html();
			    	if($.isNumeric(pqty)){
				    	processWidth=(realQty/pqty*100).toFixed(2)+"%"
				    	$("#qtyPro"+eqpCode).width(processWidth);
			    	}
			    }
			  }
			});
	}
	//定时刷新卷烟机数据
	function frushRollerQty(){
		$.ajax({
			  url: baseUrl+"/wct/realTimeData/getOutData.json?type=1",
			  cache: false,
			  success: function(msg){
				var eqpCode=null;
				var realQty=0.0;
				var pqty=1.0;
				var processWidth="0%";
			    for(var index=0;index<msg.length;index++){
			    	var data=msg[index];
			    	realQty=data.curOut;
			    	eqpCode=data.eqpCod;
			    	$("#realQty"+eqpCode).html(realQty.toFixed(2));
			    	pqty=$("#pQty"+eqpCode).html();
			    	if($.isNumeric(pqty)){
				    	processWidth=(realQty/pqty*100)+"%"
				    	$("#qtyPro"+eqpCode).width(processWidth);
			    	}
			    }
			  }
			});
	}
	//定时任务
	window.timerTaskFunction4=setInterval('frushPackerQty()',3000);
	window.timerTaskFunction5=setInterval('frushRollerQty()',3000);
	
</script>
</head>
<body>	
	<div id="main" style="margin-left: 230px;">
		<div class="clear"></div>
		<!--右侧内容-->
		<div class="right_content">
			<div id="right_contentbox">
				<!--内容标题-->
				<div class="top_title">
					<span><img src="${resRoot}/wct_web/images/ssxh/ssxh.png" /></span>
					<font id="divText">
						<#if (dataList?exists)>
							卷烟机实时产量
							<#elseif (packerList?exists)>
							包装机实时产量
						</#if>
					</font>
				</div>
				<div class="middle_box">
					<!--表单-->
					<div class="gdcx_box">
						<input type="button" class="gd_input" onclick="changeDiv(1)" value="卷烟机" name="button" />
						<input type="button" class="cz_input" onclick="changeDiv(2)" value="包装机" name="button" />
						<input type="button" class="order_input" onclick="orderData(2)" value="产量升序" name="button" />
						<input type="button" class="order_input" onclick="orderData(1)" value="产量降序" name="button" />
					</div>
				</div>
				<!--表单-->
				<div id="rollerDiv" class="bottom_content" <#if (packerList?exists)>style="display:none"</#if>>
					<div class="clear"></div>
					<#if (dataList?exists && dataList?size>0)>
							<#list dataList as data>
								<div class="one">
										<ol>
											<li>
												<#if (data.eqpName??)>${data.eqpName}</#if>
											</li>
											<li>
												<#if (data.mat)??>${data.mat}</#if> 
											</li>
											<li>
												<#if (data.teamName)??>${data.teamName}</#if> 
												<#if (data.shiftName)??>${data.shiftName}</#if>
											</li>
										</ol>
										<div class="two"></div>
										<div class="three"></div>
										<div class="four" id="qtyPro${data.eqpCode}"></div>
										<p>
											<font id="realQty${data.eqpCode}">${data.realQty?if_exists}</font>
											<font style="display:none" id="pQty${data.eqpCode}">${data.pqty?if_exists}</font>
											<font style="display:none">${data.realUnit?if_exists}</font>
											<font>箱</font>
										</p>
								</div>
							</#list> 
					</#if>
				</div>
				<!-- 包装机 -->
				<div id="packerDiv" class="bottom_content" <#if (dataList?exists)> style="display: none;"</#if>>
						<div class="clear"></div>
						<#if (packerList?exists && packerList?size>0)>
							<#list packerList as data>
										<div class="one">
											<ol>
												<li>
													<#if (data.eqpName??)>${data.eqpName}</#if>
												</li>
												<li>
													<#if (data.mat)??>${data.mat}</#if> 
												</li>
												<li>
													<#if (data.teamName)??>${data.teamName}</#if> 
													<#if (data.shiftName)??>${data.shiftName}</#if>
												</li>
											</ol>
											<div class="two"></div>
											<div class="three"></div>
											<div class="four" id="qtyPro${data.eqpCode}"></div>
											<p>
												<font id="realQty${data.eqpCode}">${data.realQty?if_exists}</font>
												<font style="display:none" id="pQty${data.eqpCode}">${data.pqty?if_exists}</font>
												${data.realUnit?if_exists}
											</p>
									</div>
								</#list> 
							</#if>
				</div>
			</div>
			
			<div class="page">
               <div class="num-bar">
				<a>共${wctPage.maxCount}条数据</a>
				<#if (wctPage.index)!=1 >
				    <a class="num" onclick="chengePage('submitBu','${futRoot}/wct/pdQty/getResultPagePath.htm?url=web_html/wct/pdStat/schStatRealTimeQty&index=${wctPage.index-1}')">上一页</a>
				<#else>
				    <a class="num" >上一页</a>  
				</#if>
				<a>${wctPage.index}/${wctPage.maxPage}</a>
				<#if (wctPage.index) < (wctPage.maxPage) >
				    <a class="num"  onclick="chengePage('submitBu','${futRoot}/wct/pdQty/getResultPagePath.htm?url=web_html/wct/pdStat/schStatRealTimeQty&index=${wctPage.index+1}')">下一页</a>
				<#else>
				    <a class="num" >下一页</a>
				</#if>
              </div>
        </div>
		</div>
	</div>
	<!-- 中部end -->
	
	<!-- 隐藏form -->
	<form  id="submitBu" action="${futRoot}/wct/pdQty/getResultPagePath.htm?url=web_html/wct/pdStat/schStatRealTimeQty" method="post">
		<input name="orderType" id="orderTypeVal" <#if (chooseParams.orderType??)>value="${chooseParams.orderType}"<#else>value="1"</#if>/>
		<input name="orderDesc" id="orderDescVal" <#if (chooseParams.orderDesc??)>value="${chooseParams.orderDesc}"<#else>value=""</#if>/>
		<input name="orderAsc" id="orderAscVal" <#if (chooseParams.orderAsc??)>value="${chooseParams.orderAsc}"<#else>value=""</#if>/>
	</form>
</body>
</html>
